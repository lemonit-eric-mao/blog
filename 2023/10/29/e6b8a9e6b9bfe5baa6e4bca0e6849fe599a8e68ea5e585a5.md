---
title: 温湿度传感器接入
date: '2023-10-29T03:02:04+00:00'
status: publish
permalink: /2023/10/29/%e6%b8%a9%e6%b9%bf%e5%ba%a6%e4%bc%a0%e6%84%9f%e5%99%a8%e6%8e%a5%e5%85%a5
author: 毛巳煜
excerpt: ''
type: post
id: 10440
category:
    - 树莓派
tag: []
post_format: []
wb_sst_seo:
    - 'a:3:{i:0;s:0:"";i:1;s:0:"";i:2;s:0:"";}'
hestia_layout_select:
    - sidebar-right
---
温湿度传感器
======

```bash
## 安装名为Adafruit_DHT的Python库。
## 这个库是由Adafruit Industries开发的，用于与DHT系列湿度和温度传感器进行通信和数据读取的库。
(dh11) [siyu.mao@raspberrypi (21:43:13) ~]
└─$ pip install Adafruit_DHT


```

编写Python代码，获取温度与湿度 `dht_sensor.py`
----------------------------------

<div style="overflow:hidden; clear:both; width: 100%; height: 40px; position: relative;">- - - - - -

 <span style="position: absolute;top: 50%;left: 50%; transform: translate(-50%, -50%); background-color: white;">以下为隐藏内容</span> </div> ```python
# dht_sensor.py
import Adafruit_DHT
import time  # 导入时间库

# 选择DHT11或DHT22传感器(一般会写在传感器上)
sensor = Adafruit_DHT.DHT11
# 指定你的插线槽孔位
# 根据你的连接配置选择正确的GPIO引脚
pin = 4

while True:  # 创建一个无限循环
    # 获取数据
    humidity, temperature = Adafruit_DHT.read_retry(sensor, pin)

    # 输出数据
    if humidity is not None and temperature is not None:
        print(f'温度: {temperature:.1f}°C')
        print(f'湿度: {humidity:.1f}%')
    else:
        print('Failed to retrieve data from the sensor')

    # 暂停一段时间（例如5秒），然后再次获取数据
    time.sleep(5)


```

**执行效果**

```bash
(dh11) [siyu.mao@raspberrypi (21:56:16) /data/dh11]
└─$ python dht_sensor.py

温度: 23.0°C
湿度: 72.0%
温度: 24.0°C
湿度: 81.0%
温度: 25.0°C
湿度: 81.0%



```

- - - - - -

使用MQTT客户端`发布`数据 `mqtt_publisher.py`
===================================

<div style="overflow:hidden; clear:both; width: 100%; height: 40px; position: relative;">- - - - - -

 <span style="position: absolute;top: 50%;left: 50%; transform: translate(-50%, -50%); background-color: white;">以下为隐藏内容</span> </div> ```python
# dht_sensor.py
import Adafruit_DHT
import time  # 导入时间库

# 选择DHT11或DHT22传感器(一般会写在传感器上)
sensor = Adafruit_DHT.DHT11
# 指定你的插线槽孔位
# 根据你的连接配置选择正确的GPIO引脚
pin = 4

while True:  # 创建一个无限循环
    # 获取数据
    humidity, temperature = Adafruit_DHT.read_retry(sensor, pin)

    # 输出数据
    if humidity is not None and temperature is not None:
        print(f'温度: {temperature:.1f}°C')
        print(f'湿度: {humidity:.1f}%')
    else:
        print('Failed to retrieve data from the sensor')

    # 暂停一段时间（例如5秒），然后再次获取数据
    time.sleep(5)


```

**测试发布信息**

```bash
(dh11) [siyu.mao@raspberrypi (22:39:03) /data/dh11]
└─$ python mqtt_publisher.py
Connected to MQTT Broker!
发布温度: 31.0°C
发布湿度: 67.0%
发布温度: 31.0°C
发布湿度: 71.0%
发布温度: 32.0°C
发布湿度: 76.0%
发布温度: 32.0°C
发布湿度: 71.0%


```

- - - - - -

- - - - - -

使用MQTT客户端`订阅`数据 `mqtt_subscriber.py`
====================================

<div style="overflow:hidden; clear:both; width: 100%; height: 40px; position: relative;">- - - - - -

 <span style="position: absolute;top: 50%;left: 50%; transform: translate(-50%, -50%); background-color: white;">以下为隐藏内容</span> </div> ```python
# dht_sensor.py
import Adafruit_DHT
import time  # 导入时间库

# 选择DHT11或DHT22传感器(一般会写在传感器上)
sensor = Adafruit_DHT.DHT11
# 指定你的插线槽孔位
# 根据你的连接配置选择正确的GPIO引脚
pin = 4

while True:  # 创建一个无限循环
    # 获取数据
    humidity, temperature = Adafruit_DHT.read_retry(sensor, pin)

    # 输出数据
    if humidity is not None and temperature is not None:
        print(f'温度: {temperature:.1f}°C')
        print(f'湿度: {humidity:.1f}%')
    else:
        print('Failed to retrieve data from the sensor')

    # 暂停一段时间（例如5秒），然后再次获取数据
    time.sleep(5)


```