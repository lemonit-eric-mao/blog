---
title: 动态生成CSS3动画，实现对话框
date: '2020-12-15T09:15:19+00:00'
status: private
permalink: /2020/12/15/%e5%8a%a8%e6%80%81%e7%94%9f%e6%88%90css3%e5%8a%a8%e7%94%bb%ef%bc%8c%e5%ae%9e%e7%8e%b0%e5%af%b9%e8%af%9d%e6%a1%86
author: 毛巳煜
excerpt: ''
type: post
id: 6651
category:
    - CSS
tag: []
post_format: []
hestia_layout_select:
    - sidebar-right
---
###### 动态生成CSS3动画

```javascript



    <meta charset="UTF-8"></meta>
    <title></title>

    
    <style>
        html, body {
            padding: 0;
            margin: 0;
            border: 0;
        }

        /*&#22320;&#22522;*/
        .dl-foundation {
            /*&#22266;&#23450;&#23450;&#20301;*/
            position: fixed;
            top: 0;
            left: 0;
            /*&#26631;&#35782;&#32972;&#26223;&#36879;&#26126;&#65292;&#24182;&#19988;&#19981;&#24433;&#21709;&#23376;&#23618;&#30340;&#36879;&#26126;&#24230;*/
            background: rgba(0, 0, 0, 0);
            /*&#26631;&#35782;&#20803;&#32032;&#27809;&#26377;&#40736;&#26631;&#20107;&#20214;&#65292;&#24182;&#19988;&#20107;&#20214;&#21487;&#20197;&#31359;&#36879;*/
            pointer-events: none;
            /*&#20805;&#28385;&#23631;&#24149;*/
            width: 100vw;
            height: 100vh;
            /*&#20351;&#29992;flexbox&#24067;&#23616;&#65292;&#35201;&#24819;&#20351;&#29992;flexbox&#27599;&#19968;&#23618;&#37117;&#24471;&#20889;display: flex;&#65292;&#23376;&#23618;&#19981;&#20250;&#32487;&#25215;&#29238;&#23618;&#30340;flexbox*/
            display: flex;
            /*&#23376;&#23618;&#23621;&#20013;*/
            align-items: center;
            justify-content: center;
        }

        /*&#23545;&#35805;&#26694;*/
        .dl-foundation > .dl-dialog {
            /*&#24403;&#21069;&#23618;&#22823;&#23567;*/
            width: 80vw;
            height: 80vh;
            /*!*&#22266;&#23450;&#23450;&#20301;*!*/
            position: fixed;
            /*&#26631;&#35782;&#24674;&#22797;&#20803;&#32032;&#40736;&#26631;&#20107;&#20214;*/
            pointer-events: auto;
            background-color: #FFF;
            display: flex;
        }

        .dl-foundation > .dl-dialog > .dl-wrapper {
            flex: 1;
            display: flex;
            flex-direction: column;
            /**
             * stretch&#65306; &#26631;&#35782;&#23376;&#23618;&#20840;&#26159;100%
             * center&#65306; &#26631;&#35782;&#23376;&#23618;&#29992;&#22810;&#23569;&#21344;&#22810;&#23569;&#24182;&#19988;&#23621;&#20013;
             */
            align-items: stretch;
        }

        /*&#26631;&#39064;&#26639;*/
        .dl-foundation > .dl-dialog > .dl-wrapper > .dl-title {
            background-color: #26b58f;
            display: flex;
            /**
             * space-between: &#26631;&#35782;&#23376;&#23618;&#20004;&#31471;&#23545;&#40784;
             */
            justify-content: space-between;
        }

        /*&#26631;&#39064;&#26639;&#25991;&#23383;*/
        .dl-foundation > .dl-dialog > .dl-wrapper > .dl-title > .dl-text {
        }

        /*&#27491;&#25991;*/
        .dl-foundation > .dl-dialog > .dl-wrapper > .dl-content {
            background-color: green;
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /*&#25353;&#38062;*/
        .dl-foundation > .dl-dialog > .dl-wrapper > .dl-buttons {
            background-color: #0077c5;
            display: flex;
            /**
             * space-around: &#26631;&#35782;&#23376;&#23618;&#20808;&#24179;&#20998;&#65292;&#21518;&#23621;&#20013;
             */
            justify-content: space-around;
            align-items: center;
        }
    </style>


<input onclick="openDialog()" type="button" value="测试弹窗"></input>

<div class="dl-foundation" id="foundation"></div>

<script>

    /**
     * &#25171;&#24320;&#23545;&#35805;&#26694;
     */
    function openDialog() {
        let template = `
            <div class="dl-wrapper">
                <div class="dl-title">
                    <div class="dl-text">&#26631;&#39064;&#26639;
                    <div>
                        <svg class="icon dl-minimize" width="20px" height="20px" viewBox="0 0 1024 1024" version="1.1"
                             xmlns="http://www.w3.org/2000/svg">
                            <path fill="#333333" d="M76.8 563.2h819.2a51.2 51.2 0 0 0 0-102.4h-819.2a51.2 51.2 0 0 0 0 102.4z"/>
                        
                    
                
                <div class="dl-content">&#27491;&#25991;
                <div class="dl-buttons">
                    <div class="dl-close">&#20851;&#38381;
                    <div>&#30830;&#23450;
                
            
        `;

        /* ------------------------------------------------------ */

        // &#22320;&#22522; &#29238;&#23618;
        let foundation = document.getElementById('foundation');
        let dialog = document.createElement('div');
        dialog.classList.add('dl-dialog');
        dialog.innerHTML = template;

        /* ------------------------------------------------------ */

        // &#33719;&#21462;&#23545;&#35805;&#26694;&#31181;&#30340;&#23481;&#22120;
        let wrapper = dialog.querySelector('.dl-wrapper');
        // &#33719;&#21462;&#27491;&#25991;
        let content = dialog.querySelector('.dl-content');
        // &#33719;&#21462;&#26368;&#23567;&#21270;&#25353;&#38062;
        let minimizeBtn = dialog.querySelector('.dl-minimize');
        // &#33719;&#21462;&#20851;&#38381;&#25353;&#38062;
        let closeBtn = dialog.querySelector('.dl-close');

        /** ======================== &#28155;&#21152;&#23646;&#24615; ======================== */

        // &#35753;&#23481;&#22120;&#20869;&#20803;&#32032;&#20107;&#20214;&#29983;&#25928;
        wrapper.style.pointerEvents = 'auto';

        // &#20026;&#20102;&#24046;&#24322;&#25928;&#26524;&#65292;&#35753;&#27491;&#25991;&#32972;&#26223;&#65292;&#38543;&#26426;&#33394;
        content.style.backgroundColor = `#<span class="katex math inline">{Math.floor(Math.random() * 0xffffff).toString(16)}`;

        // &#35774;&#32622;z-index, &#36890;&#36807;&#33719;&#21462; foundation &#29238;&#23618;&#30340;&#23376;&#33410;&#28857;&#25968;&#37327;
        let index = foundation.children.length;
        dialog.setAttribute('index', index);
        dialog.style.zIndex = index;

        /** ======================== &#28155;&#21152;&#20107;&#20214; ======================== */

        /**
         * &#26368;&#23567;&#21270;&#25353;&#38062;&#65292; &#28155;&#21152;&#28857;&#20987;&#20107;&#20214;&#65292; &#27880;&#24847; () => {} &#19982; function() {} &#30340;&#20351;&#29992;&#21306;&#21035;
         */
        minimizeBtn.onclick = () => {
            this.event.stopPropagation();
            // &#35753;&#23481;&#22120;&#20869;&#20803;&#32032;&#20107;&#20214;&#26080;&#25928;&#65307;
            wrapper.style.pointerEvents = 'none';
            // &#33719;&#21462;&#24403;&#21069;&#31383;&#20307;&#30340;&#32034;&#24341;
            let index = dialog.getAttribute('index');

            /* ------------------------------------------------------ */

            // &#28155;&#21152;&#21160;&#30011; &#32553;&#25918;+&#20301;&#31227;
            let translate = `translate(-55%,{55 - index * 10}%) scale(0.1, 0.1)`;
            dialog.animate([
                {transform: `scale(1, 1)`},
                {transform: translate}
            ], {
                duration: 500
            });
            // &#35774;&#32622;&#21160;&#30011;&#20572;&#27490;&#21518;&#30340;&#20415;&#23452;&#37327;
            dialog.style.transform = translate;
        };

        /**
         * &#36824;&#21407;&#65292; &#28155;&#21152;&#28857;&#20987;&#20107;&#20214;&#65292; &#27880;&#24847; () => {} &#19982; function() {} &#30340;&#20351;&#29992;&#21306;&#21035;
         */
        dialog.onclick = function () {
            // &#36890;&#36807;&#20107;&#20214;&#30340;&#20540;&#26469;&#21306;&#20998;&#24403;&#21069;&#31383;&#20307;&#30340;&#29366;&#24577;&#65292;&#22914;&#26524;&#24403;&#21069;&#29366;&#24577;&#19981;&#26159;&#26368;&#23567;&#21270;&#65292;&#30452;&#25509;&#36820;&#22238;
            if ('auto' === wrapper.style.pointerEvents) {
                return;
            }
            // &#35753;&#23481;&#22120;&#20869;&#20803;&#32032;&#20107;&#20214;&#29983;&#25928;
            wrapper.style.pointerEvents = 'auto';
            // &#33719;&#21462;&#24403;&#21069;&#31383;&#20307;&#30340;&#32034;&#24341;
            let index = this.getAttribute('index');

            /* ------------------------------------------------------ */

            // &#28155;&#21152;&#21160;&#30011; &#32553;&#25918;+&#20301;&#31227;
            let translate = `translate(-55%, <span class="katex math inline">{55 - index * 10}%) scale(0.1, 0.1)`;
            this.animate([
                {transform: translate},
                {transform: `scale(1, 1)`}
            ], {
                duration: 500
            });
            // &#35774;&#32622;&#21160;&#30011;&#20572;&#27490;&#21518;&#30340;&#20559;&#31227;&#37327;
            dialog.style.transform = `scale(1, 1)`;

            /* ------------------------------------------------------ */

            // &#23558; HTMLCollection &#36716;&#21270;&#20026;&#25968;&#32452;
            let items = Array.from(foundation.children);
            // &#37325;&#32622; z-index
            items.forEach((itemDialog) => {
                // &#12304;1&#12305;&#27599;&#27425;&#28857;&#20987;&#24674;&#22797;&#65292;&#37117;&#35753;&#25152;&#26377;&#20803;&#32032;&#33258;&#24049;&#20943;&#19968;&#23618;
                itemDialog.style.zIndex = --itemDialog.style.zIndex;
            });
            // &#12304;2&#12305;&#28982;&#21518;&#35753;&#24403;&#21069;&#36873;&#20013;&#30340;&#20803;&#32032;&#24674;&#22797;&#21040;&#26368;&#19978;&#23618;
            dialog.style.zIndex = items.length;
        };

        /**
         * &#20851;&#38381;&#25353;&#38062;&#65292; &#28155;&#21152;&#28857;&#20987;&#20107;&#20214;
         */
        closeBtn.onclick = () => {

            dialog.remove();

            /* ------------------------------------------------------ */

            // &#23558; HTMLCollection &#36716;&#21270;&#20026;&#25968;&#32452;
            let items = Array.from(foundation.children);
            items.forEach((itemDialog, index) => {
                let wrapper = itemDialog.querySelector('.dl-wrapper');
                itemDialog.setAttribute('index', index);

                // &#23545;&#35805;&#26694;&#29366;&#24577;&#22788;&#20110;&#25171;&#24320;&#30340;&#65292;&#19981;&#36827;&#34892;&#20301;&#31227;
                if ('none' === wrapper.style.pointerEvents) {
                    // &#35774;&#32622;&#27599;&#23618;&#30340;&#20559;&#31227;&#37327;
                    itemDialog.style.transform = `translate(-55%,{55 - index * 10}%) scale(0.1, 0.1)`;
                }
            });
        };

        // &#21152;&#20837;&#21040;&#29238;&#23618;
        foundation.appendChild(dialog);
    }

</script>


```