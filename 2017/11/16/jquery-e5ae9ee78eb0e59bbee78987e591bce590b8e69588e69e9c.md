---
title: 'jquery 实现图片呼吸效果'
date: '2017-11-16T16:40:55+00:00'
status: publish
permalink: /2017/11/16/jquery-%e5%ae%9e%e7%8e%b0%e5%9b%be%e7%89%87%e5%91%bc%e5%90%b8%e6%95%88%e6%9e%9c
author: 毛巳煜
excerpt: ''
type: post
id: 559
category:
    - JavaScript
tag: []
post_format: []
hestia_layout_select:
    - default
---
```
<pre data-language="HTML">```markup



    <title>实现多个元素呼吸效果相对布局 悬停效果 长时间悬停会停止所有</title>
    <style>
        body {
            TEXT-ALIGN: center;
        }

        .center {
            MARGIN-RIGHT: auto;
            MARGIN-LEFT: auto;
            background-image: url('image/bg_01.jpg');
            vertical-align: middle;
        }
    </style>
    <script src="jquery-3.1.0.min.js" type="text/javascript"></script>

    <script>
        /**
         * &#33719;&#21462; &#29238;&#20803;&#32032;&#23485;
         * @param parentObj
         */
        var get_parent_widht = function () {
            return <span class="katex math inline">('.center').width();
        }

        /**
         * &#33719;&#21462; &#29238;&#20803;&#32032;&#39640;
         * @param parentObj
         */
        var get_parent_height = function () {
            return('.center').height();
        }
        /**
         * &#33719;&#21462; &#29238;&#20803;&#32032;top&#20301;&#32622;
         * @param parentObj
         */
        var get_parent_top = function () {
            return <span class="katex math inline">('.center').offset().top;
        }

        /**
         * &#33719;&#21462; &#29238;&#20803;&#32032;left&#20301;&#32622;
         * @param parentObj
         */
        var get_parent_left = function () {
            return('.center').offset().left;
        }

        /**
         * &#21021;&#22987;&#21270; &#22270;&#29255;
         * @param _src
         * @returns {*|jQuery|HTMLElement}
         */
        var init_image = function (_src) {
            var img = $('<image class="breathImgId" timeoutId="" style="width:100px;height:100px"/>');
            img.attr('src', _src);
            return img;
        }

        /**
         * &#35774;&#23450; &#20256;&#20837;&#30340;&#22270;&#29255;&#22823;&#23567;
         * @param _obj
         */
        var set_size = function (_obj, width, height) {
            _obj.width(width);
            _obj.height(height);
        }

        var initLoad = function () {

            $('.center').html('');
            var array = ['1.jpg', '2.jpg', '3.jpg', '4.jpg', '5.jpg', '6.jpg', '7.jpg', '8.jpg', '9.jpg', '10.jpg', '11.jpg', '12.jpg', '13.jpg', '14.jpg', '15.jpg', '16.jpg'];
            // &#24635;&#23485;&#24230;
            var totalWidth = get_parent_widht();
            // &#24635;&#39640;&#24230;
            var totalHeight = get_parent_height();
            // &#22270;&#29255;&#30340;&#23485;
            var imgWidth = 100;
            // &#22270;&#29255;&#30340;&#39640;
            var imgHeight = 100;

            for (var i = 0; i < array.length; i++) {
                var imgObj = init_image('image/' + array[i]);
                // &#35774;&#32622;&#20301;&#32622;
                set_position(imgObj, (Math.floor(i * imgHeight / totalWidth) * imgHeight) + get_parent_top(), i * imgWidth % totalWidth + get_parent_left());
                // &#36861;&#21152;&#21160;&#30011;
                animate_breath(imgObj, getRandom(1000, 3000));
                // &#40736;&#26631;&#36827;&#20837;
                imgObj.hover(function () {
                    if ($(this).is(':animated')) {
                        $(this).stop(true, true).css('opacity', 1);
                        animate_breath_stop = true;
                    }
                    // &#40736;&#26631;&#31227;&#20986;
                }, function () {
                    animate_breath_stop = false;
                    // &#20026;&#26679;&#24335;&#20026; breathImgId &#30340;&#20803;&#32032;&#37325;&#26032;&#28155;&#21152;&#21160;&#30011;
                    $('.breathImgId').each(function () {
                        // &#36861;&#21152;&#21160;&#30011;
                        animate_breath($(this), getRandom(1000, 3000));
                    });
                });

                $('.center').append(imgObj);
            }
        }

        $(function () {
            initLoad();
        });
        /******************************** &#20197;&#19979;&#20849;&#36890;&#26159;&#24037;&#20855; *********************************/
        /**
         * &#33719;&#21462;&#38543;&#26426;&#25968;
         * @returns {number}
         */
        function getRandom(n, n1) {
            if (n &amp;&amp; n1) {
                // &#33719;&#21462;100-999&#30340;&#38543;&#26426;&#25968;&mdash;&mdash;getRandom(100, 999);
                return Math.floor(n + Math.random() * n1);
            } else if (n) {
                // &#33719;&#21462;0-999&#30340;&#38543;&#26426;&#25968;&mdash;&mdash;getRandom(999);
                return Math.floor(Math.random() * n);
            } else {
                // &#40664;&#35748; 0.0 ~ 1.0 &#20043;&#38388;&#30340;&#19968;&#20010;&#20266;&#38543;&#26426;&#25968;;
                return Math.random();
            }
        }

        /**
         * &#28155;&#21152;&#20803;&#32032;&#30340; &#21628;&#21560;&#25928;&#26524;
         */
        var animate_breath = function (obj, speed) {
            // &#22240;&#20026;&#36825;&#37324;&#26159; &#28145;&#24230;&#36882;&#24402;&#65292;&#20351;&#29992;clearTimeout() &#26159;&#26080;&#27861;&#28165;&#38500;&#30340;&#65292;&#25152;&#20197;&#33258;&#24049;&#20808;&#39044;&#30041;&#20010;&#24320;&#20851;
            if (animate_breath_stop)
                return;
            obj.animate({opacity: 0}, speed).animate({opacity: 1}, speed);
            setTimeout(animate_breath, speed * 2, obj, speed);
        }

        /**
         * &#20572;&#27490; &#21628;&#21560;&#25928;&#26524;
         */
        var animate_breath_stop = false;

        /**
         * &#35774;&#23450; &#20803;&#32032;&#30340;&#20301;&#32622;
         * @param _obj
         */
        var set_position = function (_obj, _top, _left) {
            _obj.css({position: 'absolute', 'top': _top, 'left': _left, 'z-index': 0});
        }

    </script>



<div class="center" style="width: 600px; height: 500px;"></div>




```
```