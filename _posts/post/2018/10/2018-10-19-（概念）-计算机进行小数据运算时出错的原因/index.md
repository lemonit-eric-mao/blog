---
title: "（概念 三） 计算机进行小数据运算时出错的原因"
date: "2018-10-19"
categories: 
  - "非技术文档"
---

##### 计算机运算出错的原因

```javascript
var num = 0;
for(let i = 0; i < 100; i++) {
    num += 0.1;
}
console.log(num); // 9.99999999999998
```

计算机之所以会出现运算错误, 是因为 **`有一些十进制的小数无法转换成二进制数`** 。 例如, 十进制数 **`0.1`** 就无法正确的表示。

实际上, 十进制数 **`0.1`** 转换成二进制后, 会变成 **`0.00011001100……（1100 循环）`** 这样的循环小数。这和无法用十进制数来表示 1/3 是一样的道理。 **`1/3 就是 0.3333……`**, 同样是循环小数。

因为无法正确表示的数值, 最后都变成了近似值。计算机这个功能有限的机器设备, 是无法处理无限循环的小数, 因此在遇到循环小数时, 计算机就会根据变量数据类型所对应的长度, 将数值从中间截断或者四舍五入。

**我们知道, 将 0.3333……这样的循环小数从中间截断会变成 0.333333, 这时它的 3倍是无法得出1的（结果是0.999999）, 计算机运算出错的原因也是同样的道理。**

##### \==========================================

##### 如何避免计算机计算出错

首先是 **`回避策略`** , 即无视这些错误。一般来讲, 在科学技术计算领域, 计算机的计算结果只要能得到近似值就足够了。那些微小的误差完全可以忽略掉。

另一个策略是把 **`小数转换成整数`** 来计算。例如： **`将 0.1 扩大 10倍`** 在将1相加 100次的计算, 最后把结果除以 10就可以了。

```javascript
var num = 0;
for(let i = 0; i < 100; i++) {
    num += 0.1 * 10;
}
console.log(num / 10); // 10
```
