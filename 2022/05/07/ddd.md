---
title: DDD
date: '2022-05-07T08:39:00+00:00'
status: private
permalink: /2022/05/07/ddd
author: 毛巳煜
excerpt: ''
type: post
id: 8601
category:
    - 自学整理
tag: []
post_format: []
hestia_layout_select:
    - sidebar-right
---
###### 原由

> - 201X年的时候，微服务开始流行，业务发展太快，导致团队的快速膨胀。  
>    **通过一个故事来了解技术的发展趋势**  
>    **案例:**  
>    马云2013年的时候，临退休前，他对阿里的业务进行了拆分，拆分成了25个事业部。  
>    实际情况下，25个事业部互相扯皮，阿里巴巴的首席数据官，他呢就想统一管理这25个事业部，解决这种扯皮的问题。 
>   - 他的第一个尝试就是**从底层统一**管理，也就是从**数据层面**收集上来，结果发现每个部门的数据都不一样，所以这个事儿就**没做成**，那么既然底层搞不了和不尝试从上层搞。
>   - 他的第二个尝试就是**从上层统一**管理，也就是从**业务层面**去管理，后来这个尝试也**没成功**。
>   - 在后来换人了，**张勇**借鉴之前的尝试，看到从**下面**和**上面**都不行，那就从**中间**来吧，从这个时候，阿里就提出了**中台**的概念，**`把核心业务都做成对外服务`**，想使用哪些业务就都从中台里面去调用，这个想法不错，但是实际情况因为业务的变化实在太快了，**中台显的太重**跟不上**业务的快速发展**，（例如:同样是订单服务，不同的事业部需要的订单的接口不一样）最后这个尝试实际上也是**失败了**。
> - 那么怎么办呢？既然中台这么厚重，那就**拆薄**了吧！结果又打回原形了。  
>    所以这些从**上、中、下**的尝试都失败了，后来阿里决定尝试把这件中台**变薄**，之后就引出了一个新的概念叫做**去中台化**。  
>    因为**变薄**了之后，**能方便创新**，所以现在又开始新的尝试 **DDD**
> - #### **`注意`:**
>   
>   
>   - **中台的失败的根本原因是`不能适应业务的快速变化`**。
>   - **如果你的业务变化没那么大，也没那么快，那么这就很适合中台**。
>   - **正所谓 `船小不抵风`，`船大调头难`**。所有的事都有双面性，没有一成不变的架构方案，只有根据实际情况给出更适合的方案，架构设计没有固定的标准，不能墨守成规。

- - - - - -

> - 由于整体业务发展的快速变化、软件工程系统变得越来越复杂、使用的人越来越多，我们要如何去应对这样的问题？
> - 公司能否接受这样的理念？
> - 环境又是否允许呢？ 
>   - 例如：DDD推荐的，**`一个团队`龟缩在`一个领域`里**，不过这个概念在国内很难落地，需要高层领导的支持，需要很大决心。

- - - - - -

- - - - - -

- - - - - -

###### **[康威定律](https://zhuanlan.zhihu.com/p/359452953 "康威定律")**

**第一定律** 组织沟通方式会通过系统设计表达出来。  
**第二定律** 时间再多一件事情也不可能做的完美，但总有时间做完一件事情。  
**第三定律** 线型系统和线型组织架构间有潜在的异质同态特性。  
**第四定律** 大的系统组织总是比小系统更倾向于分解。

- - - - - -

#### DDD基本概念

<table><thead><tr><th align="center">Domain</th><th align="center">Driven</th><th align="center">Design</th></tr></thead><tbody><tr><td align="center">领域</td><td align="center">驱动</td><td align="center">设计</td></tr></tbody></table>

- - - - - -

> - **在微服务架构的设计层面，`DDD`有两个特别重要的概念，`子域`和`限界上下文`。**  
>    **领域驱动**为每一个**子域**定义单独的**领域模型**。**子域**是**领域**的一部分，领域是**DDD**中用来描述**应用程序问题域**的一个术语。 
>   - **`识别子域`的方式跟`识别业务能力`一样**
>       - 分析业务并识别业务的不同专业领域，分析产出的子域定义结果也会跟业务能力非常接近。
>   - **DDD**把领域模型的边界称为**限界上下文(bounded context)**
>       - **限界上下文**包括实现这个**模型的代码集合**。当使用微服务架构时，每一个**限界上下文**对应一个或者一组服务。
>       - 换一种说法，我们可以通过**DDD**的方式定义**子域**，并**把子域对应为每一个服务**，这样就完成了微服务架构的设计工作。

- - - - - -

- **DDD**不适用小型项目，它适用于复杂的企业级项目
- **DDD**能够使用更加优雅的方式来应对业务的变化，并且随着**业务越来约复杂**我们的**代码还能继续发展**，而不是在以后，后来的人只能打补丁。

> - 如何选择 **MVC** 与 **DDD**
>   - **MVC**: 它是相对简单粗暴很容易实现的一种模式 
>       - 缺点：业务流程不清晰，不容易理解业务逻辑，后期业务累加维护更难
>   - **DDD**：选用DDD对技术人员的素质要求非常高，想用好DDD，至少需要有软件开发**设计模式**的基础 
>       - 每一个自己不同的实体都有自己不同的业务逻辑
>       - DDD如果做的不好，要比MVC还要差，设计时间长，落地时间长
>       - DDD如果做的好，的确可以应对业务的变化(设计者要**非常了解业务**，并能够 **`预测业务变化`** )

- - - - - -

##### **Domain** 实体/模型

> - **贫血模型**
>   - 不涉及任何的业务逻辑，更多的是对于数据库的访问；严格的来讲，这叫**面向数据的设计**
>   - 我们最早期使用的 **mvc** 模式中的 **model** ，它里面只有成员变量、get set 方法，很简单
>   - 包的形式(MVC设计下的包): ```
>       com.dhc.controller  # 控制层
>       com.dhc.service     # 业务逻辑层
>       com.dhc.dao         # 数据层
>       
>       ```
> - **充血模型**
>   - 我们知道**贫血模型**它里面只有成员变量， 而**充血模型**里面它可以带业务逻辑的，在**贫血模型**基础上，只要是和 **`自身`业务逻辑** 相关的 **行为(`方法`)** 完全封装在这个**实体**里面
>   - 它也是常用的一种模型
>   - 包的形式: ```
>       com.dhc.domain      # 业务的实体，业务流程写在这里，不写具体的业务实现方法，抽象层
>       com.dhc.service     # 业务逻辑层，具体的业务实现方法，也包括领域之间互通的逻辑，具体层
>       
>       ```
> - **`复用`** **封装变化**
>   - 业务变化是指**部分业务发生了变化**，不是整个业务流程都变了，因此封装变化往往使用的是，抽象出一个**接口**或**API**
>   - 流程不变，其它的中间的业务实现随你变
> - **防腐层**

- - - - - -

- - - - - -

- - - - - -